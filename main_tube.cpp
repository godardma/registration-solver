#include <codac.h>
#include <iostream>
#include <fstream>
#include <iomanip>
#include <codac.h>
#include <ibex.h>
#include <array>
#include <chrono>
#include <ctime> 

#include "codac_SepPolarXY.h"
#include "codac_SepTransform.h"
/*#include "codac_SepNot.h"
#include "codac_SepProj.h"
#include "codac_SepInverse.h"*/

using namespace std;
using namespace codac;
using namespace ibex;


void decoupe_box(IntervalVector box_a_decouper,IntervalVector& box1,IntervalVector& box2){
  if ((box_a_decouper[0].ub()-box_a_decouper[0].lb())>(box_a_decouper[1].ub()-box_a_decouper[1].lb())){
    box1[0]=Interval(box_a_decouper[0].lb(),(box_a_decouper[0].lb()+box_a_decouper[0].ub())/2.);
    box1[1]=box_a_decouper[1];
    box2[0]=Interval((box_a_decouper[0].lb()+box_a_decouper[0].ub())/2.,box_a_decouper[0].ub());
    box2[1]=box_a_decouper[1];
  }else{
    box1[1]=Interval(box_a_decouper[1].lb(),(box_a_decouper[1].lb()+box_a_decouper[1].ub())/2.);
    box1[0]=box_a_decouper[0];
    box2[1]=Interval((box_a_decouper[1].lb()+box_a_decouper[1].ub())/2.,box_a_decouper[1].ub());
    box2[0]=box_a_decouper[0];
  }
}

map<string,vector<double>> ranges {
  {"red", { 5.625143527984619, 5.6211442947387695, 5.619143962860107, 5.619143962860107, 5.627142906188965, 5.633142471313477, 5.615144729614258, 5.631142616271973, 5.619144916534424, 5.631142616271973, 5.627143383026123, 5.631142616271973, 5.645140647888184, 5.647140026092529, 5.659138202667236, 5.66513729095459, 5.653138637542725, 5.679135322570801, 5.665137767791748, 5.679135322570801, 5.679135322570801, 5.683135032653809, 5.695133209228516, 5.697132587432861, 5.703131198883057, 5.715129375457764, 5.7111310958862305, 5.727128505706787, 5.721129417419434, 5.741125583648682, 5.755123615264893, 5.749125003814697, 5.771121501922607, 5.699132442474365, 5.577150821685791, 5.585149765014648, 5.7951178550720215, 5.827112674713135, 4.971242904663086, 4.943247318267822, 5.839110851287842, 5.847109794616699, 5.849109649658203, 5.869106292724609, 5.8831048011779785, 5.907100677490234, 5.91309928894043, 5.943094730377197, 3.9713950157165527, 3.771425724029541, 3.6934375762939453, 3.699436902999878, 3.7174339294433594, 3.7034361362457275, 3.6894383430480957, 3.6894378662109375, 3.6514439582824707, 3.77142596244812, 3.759427547454834, 3.783423662185669, 3.799421548843384, 3.8274171352386475, 3.8414151668548584, 3.8634116649627686, 6.215053558349609, 6.2430500984191895, 3.807420253753662, 6.319037437438965, 6.287042617797852, 6.311039447784424, 6.33503532409668, 6.355032444000244, 6.379027843475342, 6.4110236167907715, 4.349338054656982, 6.471014499664307, 4.157366752624512, 3.969395637512207, 2.387636661529541, 2.3716390132904053, 2.339643716812134, 2.3196468353271484, 2.297650098800659, 2.2696542739868164, 2.273653745651245, 2.259655714035034, 2.2436585426330566, 2.215662717819214, 2.201664686203003, 2.2196619510650635, 2.2076640129089355, 2.1716694831848145, 2.139674186706543, 2.1236765384674072, 2.1096787452697754, 2.103679656982422, 2.1236765384674072, 2.137674331665039, 2.163670539855957, 2.1936659812927246, 2.1696696281433105, 2.1816678047180176, 2.153671979904175, 2.127676010131836, 2.1236765384674072, 2.0936810970306396, 2.075684070587158, 2.065685272216797, 2.0456883907318115, 2.0356900691986084, 2.017692804336548, 2.015692949295044, 1.9996955394744873, 1.967700481414795, 1.9637010097503662, 1.9477033615112305, 1.9397046566009521, 1.9197075366973877, 1.9077094793319702, 1.8997106552124023, 1.879713773727417, 1.8097245693206787, 1.7977262735366821, 1.7877278327941895, 1.7897274494171143, 1.7677308320999146, 1.7657310962677002, 1.7557326555252075, 1.7377355098724365, 1.7397350072860718, 1.7157387733459473, 1.7097395658493042, 1.7057403326034546, 1.6837438344955444, 1.6937421560287476, 1.6717454195022583, 1.6777445077896118, 1.6597472429275513, 1.643749713897705, 1.6497489213943481, 1.633751392364502, 1.6297519207000732, 1.619753360748291, 1.5997563600540161, 1.6077550649642944, 1.5917576551437378, 1.595757007598877, 1.5857585668563843, 1.571760654449463, 1.5817590951919556, 1.4837740659713745, 1.4797745943069458, 1.4837740659713745, 1.4657766819000244, 1.4697761535644531, 1.4557783603668213, 1.457777976989746, 1.4477795362472534, 1.433781623840332, 1.4417805671691895, 1.433781623840332, 1.4257829189300537, 1.4197838306427002, 1.415784478187561, 1.4157843589782715, 1.4157843589782715, 1.4137848615646362, 1.4017865657806396, 1.3957873582839966, 1.40178644657135, 1.3897883892059326, 1.3937877416610718, 1.385788917541504, 1.3737908601760864, 1.383789300918579, 1.3737908601760864, 1.3737908601760864, 1.3657920360565186, 1.3537938594818115, 1.371791124343872, 1.3497943878173828, 1.3557935953140259, 1.3557935953140259, 1.3437954187393188, 1.3457950353622437, 1.3397960662841797, 1.3457950353622437, 1.3337969779968262, 1.335796594619751, 1.3257982730865479, 1.323798418045044, 1.3377963304519653, 1.3217986822128296, 1.3257981538772583, 1.3098005056381226, 1.2818048000335693, 1.2958027124404907, 1.2778054475784302, 1.2778054475784302, 1.2818048000335693, 1.2738059759140015, 1.2778054475784302, 1.2798051834106445, 1.2778054475784302, 1.2538090944290161, 1.241810917854309, 1.2618077993392944, 1.2498096227645874, 1.2478100061416626, 1.2458102703094482, 1.2338123321533203, 1.255808711051941, 1.2378114461898804, 1.2458102703094482, 1.2518094778060913, 1.2338122129440308, 1.2498095035552979, 1.229812741279602, 1.2358118295669556, 1.2378114461898804, 1.2338122129440308, 1.2538090944290161, 1.2798051834106445, 1.545764684677124, 2.037689685821533, 2.0336904525756836, 2.041689157485962, 2.0336904525756836, 2.0576865673065186, 2.039689540863037, 2.0316905975341797, 2.0436885356903076, 2.041689157485962, 2.039689302444458, 2.037689447402954, 2.041689157485962, 2.069685220718384, 2.0616860389709473, 2.0696849822998047, 2.0716848373413086, 2.0616860389709473, 2.067685127258301, 2.079683303833008, 2.075684070587158, 2.0716845989227295, 2.075684070587158, 2.079683303833008, 2.0836830139160156, 2.079683303833008, 2.0836830139160156, 2.0836827754974365, 2.0996804237365723, 2.087681770324707, 2.091681480407715, 2.0996804237365723, 2.091681480407715, 2.1076791286468506, 2.0936813354492188, 2.105679512023926, 2.113678216934204, 2.113678216934204, 2.125676393508911, 2.113678216934204, 2.1336750984191895, 2.137674331665039, 2.137674331665039, 2.153672218322754, 2.141674041748047, 2.1456732749938965, 2.1456732749938965, 2.139674186706543, 2.1676700115203857, 2.1716694831848145, 2.175668716430664, 2.1816678047180176, 2.1836674213409424, 2.1916663646698, 2.2056641578674316, 2.189666748046875, 2.2096633911132812, 2.209663152694702, 2.2296605110168457, 2.225661039352417, 2.237659215927124, 2.2416586875915527, 2.2576563358306885, 2.2696547508239746, 2.249657392501831, 2.251657247543335, 2.2556562423706055, -1, 2.27565336227417, 2.263655662536621, 2.287651777267456, 2.2936506271362305, 2.3036491870880127, 2.313647747039795, 2.313647747039795, 2.3276455402374268, 2.3576409816741943, 2.3816373348236084, 2.401634454727173, 2.3896360397338867, 2.4416282176971436, 2.433629274368286, 2.4536266326904297, 2.4536266326904297, 2.437628984451294, 2.4296298027038574, 2.4296300411224365, 2.4456276893615723, 2.437628984451294, 2.4176321029663086, 2.4056336879730225, 2.3776376247406006, 2.3576409816741943, 2.335644483566284, 2.2936508655548096, 2.2936508655548096, 2.263655424118042, 2.2536568641662598, 2.2216618061065674, 2.1976654529571533, 2.1956655979156494, 2.1696696281433105, 2.15167236328125, 2.1356749534606934, 2.1076791286468506, 2.1076791286468506, 2.079683303833008, 2.067685127258301, 2.051687479019165, 2.02769136428833, 2.0236918926239014, 1.9796987771987915, 1.347794771194458, 1.3437954187393188, 1.3217986822128296, 1.3217986822128296, 1.297802448272705, -1, 1.3157997131347656, 1.335796594619751, 1.3417956829071045, 1.3237985372543335, 1.3257981538772583, 1.3257981538772583, 1.3137998580932617, 1.3337969779968262, 1.3257981538772583, 1.3237985372543335, 1.3317970037460327, 1.3177993297576904, 1.3377963304519653, 1.327797770500183, 1.3217986822128296, 1.3297975063323975, 1.315799593925476, 1.3337970972061157, 1.329797625541687, 1.3197990655899048, 1.3397960662841797, 1.3257981538772583, 1.3377963304519653, 1.327797770500183, 1.3237985372543335, 1.3397959470748901, 1.3197990655899048, 1.335796594619751, 1.3257981538772583, 1.3337969779968262, 1.3377963304519653, 1.3257981538772583, 1.3577932119369507, 1.3337969779968262, 1.3317971229553223, 1.335796594619751, 1.3317971229553223, 1.3517942428588867, 1.341795802116394, 1.3457950353622437, 1.3497943878173828, 1.3417956829071045, 1.3497943878173828, 1.3457950353622437, 1.3577932119369507, 1.359792947769165, 1.3537938594818115, 1.3617925643920898, 1.3617926836013794, 1.3577932119369507, 1.3677916526794434, 1.3557935953140259, 1.3817895650863647, 1.3677916526794434, 1.3817895650863647, 1.3697915077209473, 1.3817895650863647, 1.391788125038147, 1.3817895650863647, 1.3977872133255005, 1.4637771844863892, 1.4957722425460815, 1.4957722425460815, 1.631751537322998, 1.6797442436218262, 1.7317363023757935, 1.7917271852493286, 1.8457189798355103, 2.2796530723571777, 2.3416433334350586, 2.387636423110962, 2.4656248092651367, 2.523615837097168, 2.5916054248809814, 2.6775922775268555, 2.731584072113037, 2.235659599304199, 2.311647891998291, 2.385637044906616, 2.461625099182129, 2.5396134853363037, 2.681591749191284, 2.731584072113037, 2.905557632446289, 3.0115413665771484, 3.1615185737609863, 3.9493987560272217, 4.117372989654541, 4.311343669891357, 4.5213117599487305, 4.737278938293457, 4.987240791320801, 5.277196407318115, 5.477165699005127, 6.443018436431885, 6.421022415161133, 6.570999622344971, 7.528853416442871, 7.720824241638184, 8.350727081298828, 8.918642044067383, 8.90864372253418, 8.932639122009277, 11.274282455444336, 13.06001091003418, 18.569171905517578, 18.575172424316406, 18.577171325683594, 18.561174392700195, 18.57717514038086, 18.575172424316406, 18.549175262451172, 18.547176361083984, 18.54717445373535, 18.563173294067383, 18.561174392700195, 18.5711727142334, 18.575170516967773, 18.57917022705078, 17.323362350463867, 16.105548858642578, 14.323819160461426, 13.135998725891113, 12.344120025634766, 11.288281440734863, 10.514399528503418, 9.854499816894531, 8.944637298583984, 8.90864372253418, 8.2607421875, 8.2607421875, 8.28073787689209, 8.284738540649414, 8.320733070373535, 8.860651016235352, 8.862650871276855, 8.834654808044434, 9.046622276306152, 9.068619728088379, 6.133066177368164, 6.023082733154297, 5.833111763000488, 5.645140647888184, 5.479166030883789, 5.321188926696777, 5.17321252822876, 5.055230140686035, 4.911252021789551, 4.837263584136963, 4.771273136138916, 4.593301296234131, 4.4953155517578125, 4.381332874298096, 4.305344581604004, 4.207359313964844, 4.119372844696045, 4.031385898590088, 3.955397844314575, 3.8394150733947754, 3.843414783477783, 3.835416078567505, 3.8654115200042725, 3.8674111366271973, 3.8774096965789795, 3.8854081630706787, 3.8894076347351074, 3.9114043712615967, 3.931401491165161, 3.9413998126983643, 3.9473986625671387, 3.955397844314575, 3.985393524169922, 3.9893927574157715, 9.230594635009766, 9.270587921142578, 9.306583404541016, 9.348576545715332, 9.372572898864746, 9.406567573547363, 9.440561294555664, 9.476556777954102, 9.534547805786133, 9.56054401397705, 10.168451309204102, 9.96048355102539, 10.024473190307617, 9.926488876342773, 9.8045072555542, 9.696524620056152, 9.580541610717773, 2.0616860389709473, 2.0596864223480225, 2.029690980911255, 2.005694627761841, 1.985697627067566, 1.947703242301941, 1.9297062158584595, 1.8977110385894775, 1.8877125978469849, 1.881713628768921, 1.8717150688171387, 1.7757296562194824, 1.7577323913574219, 1.7677308320999146, 1.7397351264953613, 1.6677461862564087, 1.6717454195022583, 1.6657464504241943, 1.6677460670471191, 1.6717454195022583, 1.6597472429275513, 1.673745036125183, 1.6637465953826904, 1.6757447719573975, 1.6657465696334839, 1.6797442436218262, 1.675744891166687, 1.6757447719573975, 1.6897428035736084, 1.673745036125183, 1.6957417726516724, 1.6917423009872437, 1.6777445077896118, 1.6917423009872437, 1.6797443628311157, 1.6937421560287476, 1.7017409801483154, 1.6897426843643188, 1.7077399492263794, 1.6917423009872437, 1.7097395658493042, 1.7177382707595825, 1.7077399492263794, 1.7157387733459473, 1.713739037513733, 1.7157387733459473, 1.7177382707595825, 1.7197381258010864, 1.7477339506149292, 1.7317363023757935, 1.7337360382080078, 1.7437344789505005, 1.7457340955734253, 1.7477338314056396, 1.7497334480285645, 1.7497336864471436, 1.7477339506149292, 1.7537328004837036, 1.769730567932129, 1.7677308320999146, 1.7697306871414185, 1.7897274494171143, 1.7657309770584106, 1.7837283611297607, 1.7877278327941895, 1.7917271852493286, 1.793726921081543, 1.80572509765625, 1.8097244501113892, 1.8197228908538818, 1.8217226266860962, 1.8297213315963745, 1.8237224817276, 1.837720274925232, -1, -1, -1, -1, 1.7157387733459473, 1.7437344789505005, 1.74373459815979, 1.7837283611297607, 1.7757296562194824, 1.7877278327941895, 1.8037253618240356, 1.8157235383987427, 1.8357205390930176, 1.8357205390930176, 1.8357205390930176, -1, 1.841719627380371, 1.8317211866378784, 1.8337208032608032, 1.843719244003296, 1.8577170372009277, 1.8857128620147705, 1.879713773727417, 1.9097092151641846, 1.9117088317871094, 1.915708303451538, 1.9537025690078735, 1.9617013931274414, 1.9637010097503662, 1.985697627067566, 1.9756991863250732, 5.713129997253418, 5.78511905670166, 5.933096885681152, 6.0910725593566895, 6.187057971954346, 6.193057060241699, 6.233050346374512, 6.2370500564575195, 6.227051734924316, 6.195056438446045, 6.201055526733398, 6.185057640075684, 6.1650614738464355, 6.1650614738464355, 6.137065887451172, 6.133065700531006, 6.117069244384766, 6.113068580627441, 6.1130690574646, 6.093072414398193, 6.101070880889893, 6.0770745277404785, 6.08707332611084, 6.071075916290283, 6.061077117919922, 6.063076496124268, 6.0510783195495605, 6.041079521179199, 6.045080184936523, 6.053078651428223, 6.017083168029785, 6.015084266662598, 6.015084266662598, 6.017083644866943, 6.00708532333374, 6.019083499908447, 6.005085468292236, 6.003085136413574, 6.013084411621094, 6.0010857582092285, 6.01108455657959, 6.00708532333374, 6.015084266662598, 6.0050859451293945, 6.015084266662598, 6.013084411621094, 6.003086090087891, 6.023082733154297, 6.0150837898254395, 6.027082443237305, 6.027082443237305, 6.019083499908447, 6.035080909729004, 6.02908182144165, 6.043079853057861, 6.051078796386719, 6.047079086303711, 6.06507682800293, 6.053078651428223, 6.067076683044434, 6.071076393127441, 6.069075107574463, 6.0890727043151855, 6.0910725593566895, 6.107069492340088, 6.1150689125061035, 6.1030707359313965, 6.1270670890808105, 6.131066799163818, 6.139065265655518, 6.155062675476074, 6.155062198638916, 6.183058738708496, 6.1870574951171875, 6.199056148529053, 6.20705509185791, 6.203056335449219, 6.235050201416016, 6.231051445007324, 6.255047798156738, 6.267045974731445, 6.275044918060303, 6.299040794372559, 6.295041084289551, 6.311038494110107, 6.33103609085083, 6.339034557342529, 6.363030910491943, 6.3790283203125, 6.397026062011719, 5.95909309387207, 5.919098854064941, 5.949094295501709, 5.943095684051514, 5.9630913734436035, 5.949094295501709, 5.961092472076416, 6.009085178375244, 6.041079521179199, 6.057077407836914, 6.447018623352051, 6.610993385314941, 6.648987293243408, 6.662985801696777, 6.706978797912598, 6.714977741241455, 6.746972560882568, 6.77496862411499, 6.7829670906066895, 6.822961330413818, 6.836958408355713, 6.866954803466797, 6.8949503898620605, 6.914947032928467, 6.962939739227295, 6.978938102722168, 7.006933212280273, 7.03292989730835, 7.060925006866455, 7.10291862487793, 7.134913921356201, -1, 6.565000534057617, 6.618992328643799, 6.660985469818115, 6.674983501434326, 6.698980331420898, 6.746972560882568, 7.316885948181152, 7.432868480682373, 7.466863632202148, 7.508856296539307, 7.556849479675293, 7.582845211029053, 7.632837772369385, 7.668832302093506, 7.712825298309326, 7.756818771362305, 7.796813488006592, 7.850804328918457, 7.8947978019714355, 5.945095062255859, 5.889103412628174, 5.817114353179932, 5.787118434906006, 5.721129417419434, 5.6691365242004395, 5.625143527984619, 5.569151878356934, 5.549154758453369, 5.48916482925415, 5.451169967651367, 5.413175582885742, 5.379180908203125, 5.343186378479004, 5.303192615509033, 5.275196552276611, 5.23920202255249, 5.1992082595825195, 5.183210372924805, 5.15121603012085, 5.121220111846924, 5.091224670410156, 5.055230140686035, 5.043231964111328, 5.011236667633057, 4.9952392578125, 4.975242614746094, 4.935248851776123, 4.935248851776123, 4.901253700256348, 4.883256435394287, 4.847261905670166, 2.4936203956604004, 2.4936206340789795, 2.459625482559204, 2.4656245708465576, 2.4516265392303467, 2.4536266326904297, 2.461625099182129, 2.4556262493133545, 2.487621307373047, 2.483621835708618, 2.495620012283325, 4.647292613983154, 4.633294582366943, 4.637293815612793, 4.603299140930176, 4.607298374176025, 4.589301109313965, 4.5693039894104, 4.579302787780762, 4.567304611206055, 4.54730749130249, 4.537309169769287, 4.521312236785889, 4.515312671661377, 4.5213117599487305, 6.279043674468994, 6.2630462646484375, 6.245049476623535, 6.213054180145264, 6.2170538902282715, 6.185058116912842, 6.171060085296631, 6.155063152313232, 6.075074672698975, 6.0510783195495605, 6.031081676483154, 6.017084121704102, 6.005086421966553, 5.9930877685546875, 5.969090938568115, 6.001086235046387, 5.9930877685546875, 5.969090938568115, 5.951093673706055, 5.941095352172852, 5.915099620819092, 5.9210991859436035, 5.903100967407227, 5.659138202667236, 5.641140937805176, 5.619144439697266, 5.621143817901611, 5.603146553039551, 5.597147464752197, 5.585149765014648, 5.575150966644287, 5.601147174835205, 5.7571234703063965, 5.793118000030518, 5.781119346618652, 5.755123138427734, 5.7671217918396, 5.753123760223389, 5.7191290855407715, 5.7191290855407715, 5.7071309089660645, 5.715129375457764, 5.691133975982666, 5.691133499145508, 5.699132442474365, 5.66513729095459, 5.6811347007751465, 5.669136047363281, 5.657138347625732, 5.653139114379883, 5.657138824462891, 5.657139301300049, 5.641140460968018, 5.63914155960083, 5.645140647888184, 5.623143672943115, 5.635141849517822, 5.6291422843933105, 5.617144584655762, 5.615144729614258, 5.609145641326904, 5.6211442947387695, 5.631142616271973}},
  {"blue", { 3.699436664581299, 3.7394306659698486, 3.759427547454834, 3.7794246673583984, 3.811419725418091, 3.8494138717651367, 3.869410753250122, 3.895406484603882, 3.9274017810821533, 3.9753944873809814, 2.817570924758911, 2.797574043273926, 2.769578456878662, 2.7395830154418945, 2.795574188232422, 4.1613664627075195, 4.189362525939941, 4.223357200622559, 4.251352787017822, 4.311343669891357, 4.343338966369629, 4.387331962585449, 4.425326347351074, 4.455321788787842, 4.509313583374023, 4.549307346343994, 4.599299430847168, 4.64529275894165, 4.687286376953125, 4.7532758712768555, 4.789270401000977, 4.843262195587158, 4.905252933502197, 4.9512457847595215, 5.013236999511719, 5.059229850769043, 5.133218288421631, 5.185211181640625, 5.2372026443481445, 5.325189113616943, 5.381181240081787, 5.445170879364014, 5.5211591720581055, 5.587149143218994, 5.67113733291626, 5.717129707336426, 5.647140026092529, 5.633142471313477, 5.599147319793701, 5.6691365242004395, 5.733127117156982, 5.835111618041992, 6.405025005340576, 6.407024383544922, 6.383028030395508, 6.355032920837402, 6.345033645629883, 6.3230366706848145, 6.311038494110107, 6.305039882659912, 6.393026828765869, 2.27565336227417, 2.259655714035034, 2.2556562423706055, 2.251657247543335, 2.235659599304199, 2.2156624794006348, 2.2056641578674316, 2.1936659812927246, 2.189666509628296, 2.17366886138916, 2.187666893005371, 2.175668716430664, 2.1836674213409424, 2.1676700115203857, 2.165670156478882, 2.17366886138916, 2.149672746658325, 2.1556718349456787, 2.153671979904175, 2.149672746658325, 2.1616709232330322, 2.213663101196289, 2.2816524505615234, 2.351641893386841, 2.4196314811706543, 2.2676546573638916, 2.261655569076538, 2.261655807495117, 2.2816524505615234, 2.8495662212371826, 2.7875754833221436, 3.783423900604248, 3.2095112800598145, 3.8534131050109863, 3.385484218597412, 3.3854846954345703, 3.735431432723999, 3.79742169380188, 3.795422077178955, 3.783423900604248, 3.7894229888916016, 3.785423755645752, 3.783423900604248, 3.7754251956939697, 3.7654266357421875, 3.785423755645752, 3.7654263973236084, 3.773425340652466, 3.781424045562744, 3.761427164077759, 3.7774248123168945, 3.7694263458251953, 3.7754251956939697, 3.7774248123168945, 3.7634270191192627, 3.781424045562744, 3.773425340652466, 3.7774248123168945, 3.781424045562744, 3.781424045562744, 3.7894232273101807, 3.7794246673583984, 3.7934224605560303, 3.785423755645752, 3.783424139022827, 3.8014209270477295, 3.7914230823516846, 3.8134193420410156, 3.8014211654663086, 3.809419870376587, 3.8114194869995117, 3.811419725418091, 3.821418285369873, 3.817418336868286, 3.8254175186157227, 3.8414154052734375, 3.8274173736572266, 3.847414255142212, 3.8374156951904297, 3.843414783477783, 3.847414016723633, 3.8594119548797607, 3.871410608291626, 3.873410224914551, 3.881409168243408, 3.8774096965789795, 3.885408401489258, 3.895406484603882, 3.723433017730713, 3.6414456367492676, 3.5274627208709717, 3.4954674243927, 3.4214789867401123, 3.335491895675659, 3.2595038414001465, 3.1955134868621826, 3.117525100708008, 3.0595340728759766, 2.993544340133667, 2.9475512504577637, 2.879561185836792, 2.829569101333618, 2.78157639503479, 2.721585512161255, 2.6895904541015625, 2.625600576400757, 2.5876059532165527, 2.545612335205078, 2.4936203956604004, 2.471623659133911, 2.4156322479248047, 2.3896360397338867, 2.349642276763916, 2.309648036956787, 2.3316447734832764, 2.3296453952789307, 2.3456428050994873, 2.3536417484283447, 2.351641893386841, 2.371638774871826, 2.3656399250030518, 2.385636806488037, 2.4176321029663086, 2.4216315746307373, 2.433629274368286, 2.4436275959014893, 2.4936203956604004, 2.4896209239959717, 2.49761962890625, 2.5156168937683105, 2.5196163654327393, 2.557610511779785, 2.681591749191284, 2.695589542388916, 2.71958589553833, 2.723585367202759, 2.7475814819335938, 2.747581720352173, 2.767578363418579, 2.78157639503479, 2.7855756282806396, 2.8155713081359863, 2.819570779800415, 2.8375675678253174, 2.8395678997039795, 2.8575644493103027, 2.8835608959198, 2.889559745788574, 2.903557538986206, 2.869563102722168, 2.8715627193450928, 2.8975589275360107, 2.9115569591522217, 2.9395523071289062, 2.955549955368042, 2.9735472202301025, 2.9995434284210205, 3.003542900085449, 3.027539014816284, 3.0475358963012695, 3.0595340728759766, 3.091529369354248, 3.103527069091797, 3.1355226039886475, 3.153519630432129, 3.163518190383911, 3.1715171337127686, 3.1375224590301514, 3.1495203971862793, 3.1715171337127686, 3.1975131034851074, 3.2215094566345215, 3.2335076332092285, 3.2695021629333496, 3.2954981327056885, 3.315495252609253, 3.3554890155792236, 3.3714869022369385, 3.4094810485839844, 3.439476251602173, 3.4594733715057373, 3.4914681911468506, 3.4794702529907227, 3.521463632583618, 3.5534586906433105, 3.5434603691101074, 3.5874533653259277, 3.613449811935425, 3.6534435749053955, 5.16921329498291, 5.24320125579834, 5.241201877593994, 5.241201877593994, 5.257199764251709, 5.239202499389648, 5.205207824707031, 5.195208549499512, 5.165213584899902, 5.147216320037842, 5.123219966888428, 5.095224380493164, 5.087225437164307, 5.059229850769043, 5.043231964111328, 5.025234699249268, 5.001237869262695, 4.9952392578125, 4.959244728088379, 4.94724702835083, 4.911252021789551, 4.90325403213501, 4.881256580352783, 4.863259792327881, 4.371334552764893, 4.3593363761901855, 4.3693342208862305, 4.373333930969238, 4.371334552764893, 4.385332107543945, 4.385332107543945, 4.411328315734863, 4.40532922744751, 4.415328025817871, 4.439323902130127, 4.443323612213135, 4.451322078704834, 4.459321022033691, 4.467319965362549, 4.461320877075195, 4.473318576812744, 4.493315696716309, 4.493316173553467, 4.499314785003662, 4.641293048858643, 4.821265697479248, 5.081226348876953, 5.547155380249023, 5.675135135650635, 5.741125583648682, 5.489164352416992, 5.641140937805176, 5.813114643096924, 6.017083644866943, 6.267045021057129, 6.890950679779053, 7.100918769836426, 7.340882301330566, 7.568847179412842, 7.848804950714111, 8.124762535095215, 8.468709945678711, 8.762665748596191, 9.544547080993652, 9.544547080993652, 10.63637924194336, 10.626381874084473, 10.81035327911377, 11.960179328918457, 12.004172325134277, 12.008171081542969, 12.788053512573242, 14.191838264465332, 14.517788887023926, 15.743602752685547, 16.905426025390625, 18.593168258666992, 21.630706787109375, 21.616708755493164, 21.612709045410156, 21.612709045410156, 21.62070655822754, 21.588712692260742, 21.554718017578125, 21.57671546936035, 21.564716339111328, 21.58071517944336, 21.57471466064453, 21.57671546936035, 11.942181587219238, 11.780205726623535, 11.714216232299805, 11.57023811340332, 4.2973456382751465, 4.301344871520996, 4.269349575042725, 4.261351108551025, 4.237354755401611, 4.215358257293701, 4.215358257293701, 4.171365261077881, 4.155367374420166, 4.125371932983398, 4.115373134613037, 4.107374668121338, 4.075379371643066, 4.079379081726074, 4.039384841918945, 4.047383785247803, 4.0273871421813965, 3.869410753250122, 3.8734099864959717, 3.8554129600524902, 3.845414400100708, 3.835415840148926, 3.821418285369873, 3.8254175186157227, 3.809419870376587, 3.8034210205078125, 3.7774248123168945, 3.7554283142089844, 3.757427930831909, 3.7514283657073975, 3.747429609298706, 3.745429754257202, 3.7414300441741943, 3.7254326343536377, 4.735278606414795, 4.757275581359863, 4.729279518127441, 4.76927375793457, 4.787271022796631, 4.5213117599487305, 4.807267665863037, 4.819266319274902, 4.613297462463379, 4.8412628173828125, 4.8412628173828125, 4.6812872886657715, 4.875258445739746, 4.885256290435791, 4.677288055419922, 4.921250820159912, 4.935249328613281, 4.695284843444824, 4.961244583129883, 4.509313583374023, 4.985240459442139, 5.007237911224365, 5.023234844207764, 5.031233787536621, 5.0912251472473145, 1.0138455629348755, 1.0218443870544434, 1.0098462104797363, 0.9998477101325989, 1.0178450345993042, 0.9978480339050293, 0.9998477101325989, 0.9918489456176758, 0.9638532996177673, 0.9958482980728149, 0.9838502407073975, 0.9878495335578918, 0.989849328994751, 0.9838501811027527, 1.0098462104797363, 0.9918490052223206, 0.9978479743003845, 0.9978480339050293, 1.001847505569458, 1.0098462104797363, 1.0058468580245972, 1.0178450345993042, 1.0158452987670898, 1.0198447704315186, 1.0298430919647217, 1.0418413877487183, 1.1258286237716675, -1, 5.743125915527344, 5.7671217918396, 5.785119533538818, 5.821114540100098, 5.841110706329346, 5.8911027908325195, 5.919098854064941, 5.945094585418701, 6.001086235046387, 6.027082443237305, 6.06107759475708, 6.1050705909729, 6.133066654205322, 6.193057060241699, 6.217052936553955, 6.267045974731445, 6.301041126251221, 6.341034412384033, 6.393026828765869, 6.431020259857178, 6.481013298034668, 6.523006439208984, 6.563000679016113, 6.628990650177002, 6.660985946655273, 6.718976974487305, 6.770968437194824, 6.816962718963623, 6.866954803466797, 6.804963111877441, 6.8569560050964355, 6.808963298797607, 6.764969825744629, 6.712977886199951, 6.670984268188477, 6.65098762512207, 6.618992328643799, 6.559001445770264, 6.531005859375, 6.471014499664307, 6.4450178146362305, 6.4110236167907715, 6.3850274085998535, 6.345033645629883, 6.287042617797852, 6.2890424728393555, 6.243049621582031, 6.17905855178833, 6.1650614738464355, 6.13506555557251, 6.115069389343262, 6.0770745277404785, 6.047079563140869, 6.025082588195801, 5.997087001800537, 5.969091415405273, 5.963091850280762, 5.91309928894043, 5.90910005569458, 5.881104946136475, 5.861107349395752, 5.8331122398376465, 5.809115409851074, 5.8031158447265625, 5.7691216468811035, 3.8494138717651367, -1, 5.701132297515869, 5.67113733291626, 5.653139114379883, 5.657138824462891, 5.625144004821777, 5.617144584655762, 5.597147464752197, 5.571151256561279, 5.577150821685791, 5.547155380249023, 5.54115629196167, 5.517159938812256, 5.501162528991699, 5.497162818908691, 5.471166610717773, 5.469167232513428, 5.451169967651367, 5.433173179626465, 5.429173469543457, 5.4111762046813965, 5.3971781730651855, 5.389179706573486, 5.377181053161621, 5.3851799964904785, 5.357184410095215, 5.349185466766357, 5.337187767028809, 5.3211894035339355, 5.325189113616943, 5.305191993713379, 5.307191848754883, 5.271197319030762, -1, 4.107374668121338, 4.097375869750977, 4.087378025054932, -1, 4.065380573272705, 4.07737922668457, 4.05938196182251, -1, 4.047383785247803, 4.03338623046875, 4.05938196182251, -1, 4.609298229217529, 4.611297607421875, 4.607298374176025, 4.611297607421875, 4.597300052642822, 4.60529899597168, 4.639293670654297, 5.163213729858398, 5.17321252822876, 5.15121603012085, 5.167212963104248, 5.167212963104248, 5.147216320037842, 5.1612138748168945, 5.135218143463135, 5.135218143463135, 5.141217231750488, 5.135218143463135, 5.141217231750488, 5.135218143463135, 5.143216609954834, 5.139217376708984, 5.143216609954834, 5.153215408325195, 5.15121603012085, 5.147216320037842, 5.147216320037842, 5.155214786529541, 5.169212818145752, 5.159214496612549, 5.169212818145752, 5.169212818145752, 5.183210372924805, 5.179211616516113, 5.1752119064331055, 5.189209461212158, 4.6812872886657715, 4.727280139923096, 5.185210704803467, 5.1992082595825195, 5.207207202911377, 5.209206581115723, 5.22120475769043, 5.223205089569092, 5.22120475769043, 5.241201877593994, 4.723280906677246, 4.727280139923096, 5.253200054168701, 5.255199432373047, 5.273197174072266, 5.279196262359619, 5.283195495605469, 5.295194149017334, 5.305191993713379, 5.325189113616943, 5.327188491821289, 3.261503219604492, 3.155519485473633, 3.0615334510803223, 3.007542133331299, 2.9115567207336426, 2.845566749572754, 2.7795767784118652, 2.719585657119751, 2.6915900707244873, 2.633599042892456, 2.5896058082580566, 2.5396134853363037, 2.487621307373047, 2.471623659133911, 2.4296300411224365, 2.397634506225586, 2.3656396865844727, 2.323646306991577, 2.289651393890381, 2.2456579208374023, 2.237659215927124, 2.1916663646698, 2.175668716430664, 2.149672746658325, 2.1196773052215576, 2.1116783618927, 2.0856826305389404, 2.0696849822998047, 2.0456883907318115, 2.017692804336548, 2.0136935710906982, 1.9876972436904907, 1.979698657989502, 1.9617013931274414, 1.9337055683135986, 1.9277064800262451, 1.905709981918335, 1.8977110385894775, 1.8897122144699097, 1.8617165088653564, 1.8617165088653564, 1.841719627380371, 1.8417197465896606, 1.8357205390930176, 1.8257219791412354, 1.8537178039550781, 4.469319820404053, 4.657290458679199, 4.613297462463379, 4.557305812835693, 4.535309791564941, 4.4693193435668945, 4.429325580596924, 4.391331195831299, 4.349338054656982, 4.3233418464660645, 4.263350963592529, 4.227356433868408, 4.189362049102783, 4.141369342803955, 4.119372367858887, 4.07737922668457, 3.3314929008483887, 3.3054966926574707, 3.263503074645996, 3.2595038414001465, 3.217510461807251, 3.193514108657837, 3.1695172786712646, 3.1375224590301514, 3.1335227489471436, 3.0975282192230225, 3.103527069091797, 3.091529369354248, -1, -1, -1, -1, -1, -1, 2.895559072494507, -1, -1, -1, 3.413480281829834, 3.3354921340942383, 3.313495397567749, 3.3294930458068848, 3.3294930458068848, 3.3674874305725098, 3.3574888706207275, 3.3294930458068848, 3.315495252609253, 3.2934985160827637, 3.2575039863586426, 3.2595038414001465, 3.225508689880371, 3.213510751724243, 3.20351243019104, 3.1975131034851074, 3.175516128540039, 3.153519630432129, 3.1475207805633545, 3.1255240440368652, 3.1175248622894287, 3.103527069091797, 3.0855300426483154, 3.079531192779541, 3.055534839630127, 2.98154616355896, 2.9735472202301025, 2.9495508670806885, 2.9635488986968994, 2.9375524520874023, 2.5436127185821533, 2.9135565757751465, 2.889559745788574, 2.8995585441589355, 2.8775620460510254, 2.869563341140747, 2.8635640144348145, 2.84356689453125, 2.84356689453125, 2.879561424255371, 2.8915598392486572, 2.855565309524536, 2.853565216064453, 2.845566749572754, 2.831568956375122, 2.829568862915039, 2.8115718364715576, 2.809572219848633, 2.8035731315612793, 2.79557466506958, 2.7995736598968506, 2.7875754833221436, 2.7755773067474365, 2.767578601837158, 2.755580425262451, 2.7615795135498047, 2.5136172771453857, 2.499619245529175, 2.509618043899536, 2.483621835708618, 2.4916205406188965, 2.47562313079834, 2.487621307373047, 2.4676244258880615, 2.451626777648926, 2.471623659133911, 2.4556260108947754, 2.451626777648926, 2.447627305984497, 2.4396283626556396, 2.4436278343200684, 2.4316296577453613, 2.4316298961639404, 2.4276304244995117, 2.4196314811706543, 2.4696238040924072, 2.543612480163574, 2.6395981311798096, 2.6495964527130127, 2.645597219467163, 2.6515963077545166, 2.6415977478027344, 2.6375982761383057, 2.6415977478027344, 2.6275997161865234, 2.6395983695983887, 2.6275997161865234, 2.6295995712280273, 2.623600482940674, 2.619601011276245, 2.625600576400757, 2.5996041297912598, 2.609602689743042, 2.6136019229888916, 2.6056032180786133, 2.619601011276245, 2.5996041297912598, 2.607602834701538, 2.609602689743042, 2.5956051349639893, 2.611602544784546, 2.5996041297912598, 2.6056034564971924, 2.5996041297912598, 2.6036036014556885, 2.611602544784546, 2.6016037464141846, 2.617601156234741, 2.611602544784546, 2.611602783203125, 2.611602544784546, 2.6036036014556885, 2.621600866317749, 2.6136019229888916, 2.6176013946533203, 2.6256003379821777, 2.623600482940674, 2.6295995712280273, 2.621601104736328, 2.6315994262695312, 2.633599042892456, 2.6295993328094482, 2.6315994262695312, 2.6295995712280273, 2.633599042892456, 2.6375980377197266, 2.6295995712280273, 2.65759539604187, 2.643597364425659, 2.647597074508667, 2.6635942459106445, 2.659595012664795, 2.6735928058624268, 2.659595251083374, 2.6755926609039307, 2.671593189239502, 2.6735928058624268, 2.683591365814209, 2.6895904541015625, 2.6755926609039307, 2.721585512161255, 2.7035884857177734, 2.7155861854553223, 2.7015886306762695, 2.7135865688323975, 2.721585512161255, 2.7175865173339844, 2.733583927154541, 2.729584217071533, 2.7375831604003906, 2.7535808086395264, 2.7535808086395264, 2.7735776901245117, 2.7735776901245117, 2.7775771617889404, 2.78157639503479, 2.7795770168304443, 2.809572219848633, 2.8155713081359863, 2.8275694847106934, 2.845566987991333, 2.8475663661956787, 2.8515658378601074, 2.8515655994415283, 2.8635640144348145, 2.867563247680664, 2.869563102722168, 2.8995585441589355, 2.9095568656921387, 2.929553747177124, 2.933553695678711, 2.9495508670806885, 2.9615488052368164, 2.957549810409546, 2.979546546936035, 2.9875450134277344, 3.015540838241577, 3.0115413665771484, 3.0215396881103516, 3.0495357513427734, 3.053534984588623, 3.0715322494506836, 3.079531192779541, 3.0855302810668945, 3.115525722503662, 3.1095263957977295, 3.1335227489471436, 3.155519485473633, 3.1675174236297607, 3.1975131034851074, 3.193513870239258, 3.213510751724243, 3.227508544921875, 3.2335076332092285, 3.2695021629333496, 3.277500629425049, 3.2934985160827637, 3.315495014190674, 3.327493190765381, 3.3614883422851562, 3.3714864253997803, 3.3054966926574707, 3.2834997177124023, 3.267502784729004, 3.2555041313171387, 3.2075116634368896, 3.2315080165863037, 3.4314775466918945, 3.5294625759124756, 3.575455665588379, 3.585453987121582, 3.611450433731079, 3.5954525470733643, 3.663442373275757 }},
  {"green", { 3.2695021629333496, 3.2834997177124023, 3.2715017795562744, 3.2914984226226807, 3.277500867843628, 3.28749942779541, 3.277500629425049, 3.279500722885132, 3.28749942779541, 3.2815003395080566, 3.2855000495910645, 3.2954981327056885, 3.2854995727539062, 3.2954983711242676, 3.289499282836914, 3.2974979877471924, 3.301497220993042, 3.2974979877471924, 3.303497076034546, 3.289499282836914, 3.31349515914917, 3.2954983711242676, 3.2954986095428467, 3.327493190765381, 3.3194944858551025, 3.3214943408966064, 3.3354921340942383, 3.32749342918396, 3.3434908390045166, 3.3354921340942383, 3.347490072250366, 3.3554890155792236, 3.341491460800171, 3.3594884872436523, 3.3674874305725098, 3.3654873371124268, 3.3794853687286377, 3.3654873371124268, 3.3914835453033447, 3.3914835453033447, 3.3914835453033447, 3.4074811935424805, 3.399482488632202, 3.4174795150756836, 3.4174797534942627, 3.4334774017333984, 3.437476634979248, 3.439476251602173, 3.463472604751587, 3.4594736099243164, 3.473471164703369, 3.4794704914093018, 3.4834697246551514, 3.5034666061401367, 3.499467134475708, 3.523463487625122, 3.5294625759124756, 3.521463632583618, 3.5554587841033936, 3.547459840774536, 3.5954525470733643, -1, 1.6837437152862549, 1.6697458028793335, 1.6897428035736084, 3.6314470767974854, 3.6294474601745605, 3.645444869995117, 3.661442518234253, 3.661442279815674, 3.6894381046295166, 3.647444725036621, 3.0875298976898193, 3.0755317211151123, 3.053534984588623, 3.067532777786255, 3.0735318660736084, 3.1015279293060303, 3.1315231323242188, 3.139521837234497, 2.965548515319824, 2.9615488052368164, 2.953550338745117, 3.1755166053771973, 3.193513870239258, 3.2335076332092285, 3.2555041313171387, 3.263503074645996, 3.2315080165863037, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4.381332874298096, 4.401330471038818, 4.42732572555542, 4.443323612213135, 4.487317085266113, 4.50331449508667, 4.539309024810791, 4.567304611206055, 4.599299907684326, 4.639293670654297, 4.661290168762207, 4.707283020019531, 4.735278606414795, -1, 4.073379993438721, 4.05938196182251, -1, 4.911252021789551, 4.937248229980469, 4.997239112854004, 5.023234844207764, 4.305344581604004, 4.327341079711914, 4.291346549987793, 4.2973456382751465, 5.2332024574279785, 5.317190647125244, 5.341187000274658, 5.367182731628418, 5.451169967651367, 5.4871649742126465, 5.553154468536377, 5.603146553039551, 5.657139301300049, 5.723128795623779, 5.767122268676758, 5.8291120529174805, 5.8911027908325195, 5.95709228515625, 5.987088680267334, 5.945094585418701, 5.927097797393799, 5.911099910736084, 5.88310432434082, 5.859107971191406, 5.817114353179932, 5.813114166259766, 5.775120735168457, 5.753123760223389, 5.735126495361328, 5.713129997253418, 5.7051310539245605, 5.671136856079102, 3.7194337844848633, 3.697437047958374, 3.65944242477417, 3.661442518234253, 3.6334469318389893, 3.623448133468628, 3.6054511070251465, 3.575455665588379, 3.5774552822113037, 3.551459550857544, 3.5454602241516113, 3.5294625759124756, 3.513465166091919, 3.51346492767334, 3.487468957901001, 3.489468812942505, 3.4774703979492188, 3.4554736614227295, 3.4574737548828125, 3.4454753398895264, 3.4314775466918945, 3.427478075027466, 3.413480281829834, 3.4194791316986084, 3.3974828720092773, 3.399482488632202, 3.3834846019744873, 3.3814854621887207, 3.3834848403930664, 3.3674874305725098, 3.3694868087768555, 3.3554890155792236, 3.339491605758667, 3.3554890155792236, 3.3354921340942383, 3.3434908390045166, 3.3354921340942383, 3.3174948692321777, 3.327493190765381, 3.315495252609253, 3.3234941959381104, 3.3074963092803955, 3.303497076034546, 3.313495397567749, 3.2954981327056885, 3.2934987545013428, 3.303497076034546, 3.2834997177124023, 3.2914984226226807, 3.2874996662139893, 3.2914986610412598, 3.2914986610412598, 3.2815003395080566, 3.2934985160827637, 3.2815003395080566, 3.2854998111724854, 3.2834999561309814, 3.289499521255493, 3.289499044418335, 3.2815005779266357, 3.2954981327056885, 3.2954983711242676, 3.3054966926574707, 3.301497220993042, 3.2914984226226807, 3.311495542526245, 3.2914984226226807, 3.299497604370117, 3.313495635986328, 3.2934987545013428, 3.3214941024780273, 3.3074960708618164, 3.311495780944824, 3.3354921340942383, 3.3354921340942383, 3.3314929008483887, 3.327493190765381, 3.351490020751953, 3.353489398956299, 3.351489782333374, 3.3714864253997803, 3.363487720489502, 3.3674871921539307, 3.3814852237701416, 3.3834846019744873, 3.399482011795044, 3.3934829235076904, 3.4074811935424805, 3.417479991912842, 3.4194791316986084, 3.4314775466918945, 3.435476779937744, 3.4434757232666016, 3.451474189758301, 3.4574735164642334, 3.485468864440918, 3.4834697246551514, 5.113221645355225, 5.129219055175781, 5.009237289428711, 4.925250053405762, 4.917251110076904, 4.929249286651611, 4.921250820159912, 4.939247131347656, 4.9552459716796875, 4.957245349884033, 4.96924352645874, 4.9772419929504395, 4.979241847991943, 5.243201732635498, 5.23920202255249, 5.255199432373047, 5.269197940826416, 5.261198997497559, 5.285195350646973, 5.299192905426025, 5.29719352722168, 5.313190937042236, 5.321188926696777, 5.345186233520508, 5.353184700012207, 5.361184120178223, 5.403177738189697, 5.403176784515381, 5.439172267913818, 5.451169967651367, 5.451169967651367, 5.467167854309082, 5.473166465759277, 5.517159938812256, 5.515160083770752, 5.539156913757324, 5.553154468536377, 5.557153701782227, 5.565152168273926, 5.589149475097656, 5.647140026092529, 5.66113805770874, 5.675135612487793, 5.6871337890625, 5.701131820678711, 5.723128795623779, 5.747125148773193, 5.765121936798096, 5.827112674713135, 5.83511209487915, 5.863106727600098, 5.881104946136475, 5.949094295501709, 5.9530930519104, 5.981088638305664, 6.009084701538086, 6.027082443237305, 6.067075729370117, 6.081074237823486, 6.121068000793457, 6.155062675476074, 6.175059795379639, 6.217052936553955, 6.241049289703369, 6.277044296264648, 6.307039260864258, 6.33103609085083, 1.9417043924331665, 1.9317058324813843, 1.9177080392837524, 1.9117088317871094, 1.8897124528884888, 1.8957113027572632, 1.8897123336791992, 1.899710774421692, 1.9057097434997559, 1.8957114219665527, 1.911708950996399, 1.9137085676193237, 1.9257067441940308, 1.9437041282653809, 1.9557021856307983, 6.986936092376709, 7.010932922363281, 7.066924095153809, 7.132914066314697, 7.154910087585449, 7.2408976554870605, 7.26689338684082, 7.3508806228637695, 7.398873805999756, 7.466863632202148, 7.518855094909668, 7.570847511291504, 7.644835948944092, 7.694828510284424, 7.758818626403809, 7.826808452606201, 7.886798858642578, 7.968786716461182, 5.079226970672607, 5.083225727081299, 4.995238780975342, 5.003238201141357, 4.987241268157959, 4.9392476081848145, 4.899253845214844, 4.895254611968994, 4.8872551918029785, 5.011236667633057, 4.953246116638184, 4.949246406555176, 5.19120979309082, 9.090615272521973, 9.196599960327148, 9.162605285644531, 9.132609367370605, -1, 5.429173469543457, 9.166604042053223, 9.19260025024414, -1, 9.37457275390625, 5.6871337890625, -1, 5.991087436676025, 5.913099765777588, 6.059077739715576, 6.271045207977295, 6.371030330657959, 6.287042617797852, 6.275044918060303, 6.259047031402588, 6.223052024841309, 6.215053558349609, 6.187057971954346, 6.169060230255127, 6.1530632972717285, 6.125067234039307, 6.123067378997803, 6.093072414398193, 6.08707332611084, 6.06107759475708, 6.039080619812012, 6.033081531524658, 6.011085033416748, 5.997086524963379, 4.203359603881836, 4.195361137390137, 4.20136022567749, 4.181363105773926, 4.175363540649414, 4.17936372756958, 4.171365261077881, 4.167366027832031, 4.169365406036377, 4.18336296081543, 4.173364639282227, 4.141369342803955, 4.153367042541504, 4.169364929199219, 4.255352020263672, 4.243354320526123, 4.227356433868408, 4.241353988647461, 4.213358402252197, 4.219357967376709, 4.207359790802002, 4.207359313964844, 4.193361759185791, 4.185362815856934, 4.195361137390137, 4.171365261077881, 4.173364639282227, 4.175364017486572, 4.155367374420166, 4.119372367858887, 4.103375434875488, 4.101375579833984, 4.107374668121338, 4.097375869750977, 4.10337495803833, 4.093376636505127, 4.095376491546631, 4.087377548217773, 4.0853776931762695, 4.095376491546631, 4.089377403259277, 4.089377403259277, 4.087377548217773, 4.069380283355713, 4.08137845993042, 4.00538969039917, 4.019387722015381, 4.011388778686523, 3.9993908405303955, 4.019387722015381, 4.0013909339904785, 4.011389255523682, 4.013389587402344, 4.0013909339904785, 4.019387722015381, 4.0133891105651855, 4.019387722015381, 4.0133891105651855, 4.015388488769531, 4.0273871421813965, 4.023387432098389, 4.025386810302734, 4.017388343811035, 3.9973912239074707, 4.011389255523682, 3.9793944358825684, 3.993391990661621, 3.9973912239074707, 3.993391990661621, 4.015388488769531, 4.0273871421813965, 4.811267375946045, 4.841263294219971, 4.837263584136963, 4.863259792327881, 4.871258735656738, 4.865259647369385, 4.859260082244873, 4.867258071899414, 4.8912553787231445, 4.881257057189941, 4.89325475692749, 4.885255813598633, 4.909252643585205, 4.923250198364258, 4.927249908447266, 4.945246696472168, 4.949246883392334, 4.971242904663086, 4.963244438171387, 4.975242614746094, 5.011236667633057, 5.011236667633057, 5.0152363777160645, 5.039233207702637, 5.019236087799072, 5.0192365646362305, 5.033234119415283, 5.063229084014893, 5.057229995727539, 5.09322452545166, 5.135218143463135, 5.131218433380127, 5.159214496612549, 3.843414783477783, 5.153215408325195, 3.9913923740386963, 3.9473989009857178, 3.9753947257995605, 3.945399045944214, 3.91740345954895, 3.91740345954895, 3.8914074897766113, 3.88140869140625, 3.8774099349975586, 3.8614120483398438, 3.8554129600524902, 3.835416078567505, 3.8294169902801514, 3.8114194869995117, 3.7914230823516846, 3.7874231338500977, 3.771425724029541, 3.759427547454834, 3.7514283657073975, 3.7394306659698486, 3.7554283142089844, 3.7794246673583984, 3.785423755645752, 3.809419870376587, 3.8634119033813477, 3.8894076347351074, 3.8894076347351074, 3.9014062881469727, 3.921402931213379, 3.919402837753296, 3.9733951091766357, 3.981393575668335, 4.0093889236450195, 4.089377403259277, 4.187362194061279, 4.225356578826904, 4.237354755401611, 4.2593512535095215, 4.287347316741943, 4.301344871520996, 4.343338966369629, 4.363335609436035, 4.3853325843811035, 4.421327114105225, 4.255352020263672, 4.305344581604004, 4.3213419914245605, 4.34733772277832, 4.379333019256592, 4.411328315734863, 4.441323757171631, 4.461320877075195, 4.511312961578369, 4.543308258056641, 4.581302642822266, 4.60529899597168, 4.615297317504883, 4.673288345336914, 4.717282295227051, 4.765274524688721, 4.787271022796631, 4.8532609939575195, 1.8777142763137817, 1.8657159805297852, 1.843719244003296, 1.8657158613204956, 1.8297213315963745, -1, 1.7777293920516968, 1.6477491855621338, 1.6237527132034302, 1.595757007598877, 1.5937573909759521, 1.5617622137069702, 1.5397655963897705, 1.4917727708816528, 1.4757752418518066, 1.527767300605774, 1.4597777128219604, 1.4477795362472534, 1.5237679481506348, 1.4757752418518066, 1.5757601261138916, 1.5757601261138916, -1, 2.21366286277771, 2.115678071975708, 2.175668716430664, 1.9537025690078735, 1.9577019214630127, 1.965700626373291, 2.17366886138916, 2.1676700115203857, 2.113678216934204, 2.163670539855957, 2.189666509628296, 2.2036643028259277, 2.215662717819214, 2.2696545124053955, 2.3056488037109375, 2.1596710681915283, 2.1836674213409424, 2.1936662197113037, 2.1676700115203857, 2.079683303833008, 2.141674041748047, 2.127676010131836, 1.9756993055343628, 2.1216771602630615, 2.1296756267547607, 2.0596864223480225, 2.105679512023926, 2.101679801940918, 2.087682008743286, 2.065685272216797, 2.079683303833008, 2.0836827754974365, 2.105679512023926, 2.1336748600006104, 2.153671979904175, 2.261655569076538, 2.251657247543335, 2.2216618061065674, 2.239658832550049, 2.249657392501831, 2.2396585941314697, 2.2216618061065674, 2.2316601276397705, 2.2196619510650635, 2.223661422729492, 2.1816678047180176, 2.2096633911132812, 2.2076640129089355, 2.187666893005371, 2.189666509628296, 2.1956655979156494, 2.1956658363342285, 2.1836674213409424, 2.1536717414855957, 2.189666748046875, 2.177668571472168, 2.177668571472168, 2.165670394897461, 2.1716694831848145, 2.1836674213409424, 2.159670829772949, 1.7877278327941895, 2.165670156478882, 2.155672073364258, 2.1696696281433105, 1.769730567932129, 2.161670684814453, 2.15167236328125, 2.15167236328125, 1.7837282419204712, 2.1556718349456787, 2.163670539855957, 2.149672746658325, -1, 2.15167236328125, 2.1476728916168213, 2.1456735134124756, 2.0316905975341797, 1.7097394466400146, 2.1296756267547607, 2.139673948287964, 2.153672218322754, 2.1456732749938965, 2.1476728916168213, 2.15167236328125, 2.1436736583709717, 2.1556718349456787, 2.1476728916168213, 2.1556718349456787, 2.15167236328125, 2.139674186706543, 2.1596710681915283, 2.15167236328125, 2.1596710681915283, 2.153671979904175, 2.153672218322754, 2.1596713066101074, 2.149672746658325, 2.1596710681915283, 2.1676700115203857, 2.1496729850769043, 2.1676700115203857, 2.1596710681915283, 2.1716694831848145, 2.1696696281433105, 2.165670156478882, 2.1856675148010254, 2.175668716430664, 2.025691270828247, 2.003695011138916, 1.9956960678100586, 2.0116937160491943, 2.0136935710906982, 2.041689157485962, 2.1336750984191895, 2.1216771602630615, 2.211663007736206, 2.2076640129089355, 2.21366286277771, 2.2196617126464844, 2.215662717819214, 2.2316601276397705, 2.225661039352417, 2.2336599826812744, 2.235659599304199, 2.2316601276397705, 2.2476577758789062, 2.2456581592559814, 2.2676546573638916, 2.2576563358306885, 2.2696547508239746, 2.2716541290283203, 2.2696542739868164, 2.2956502437591553, 2.2836523056030273, 2.299649953842163, 2.299650192260742, 2.2936508655548096, 2.3296453952789307, 2.315647602081299, 2.3276455402374268, 2.3296453952789307, 2.3296453952789307, 2.3536415100097656, 2.3556413650512695, 2.3596408367156982, 2.3696389198303223, 2.371638774871826, 2.3936352729797363, 2.397634744644165, 2.4056336879730225, 2.4176321029663086, 2.4096333980560303, 2.437628984451294, 2.43562912940979, 2.451626777648926, 2.459625482559204, 2.459625482559204, 2.487621307373047, 2.483621835708618, 2.5056183338165283, 2.511617422103882, 2.5076181888580322, 2.5316145420074463, 2.5416128635406494, 2.5536112785339355, 2.5676090717315674, 2.5676090717315674, 2.59560489654541, 2.5996041297912598, 2.6156017780303955, 2.631599187850952, 2.6315994262695312, 2.659595251083374, 2.6635942459106445, 2.683591365814209, 2.6995887756347656, 2.6995887756347656, 2.7255849838256836, 2.731584072113037, 2.7535808086395264, 2.7795767784118652, 2.783576250076294, 2.8135716915130615, 2.82157039642334, 2.8395676612854004, 2.8615641593933105, 2.8635640144348145, 2.8975589275360107, 2.903557777404785, 2.929553747177124, 2.9495508670806885, 2.993544340133667, 3.007542133331299, 3.019540309906006, 3.0515353679656982, 3.065533399581909, 3.103527307510376, 3.1235244274139404, 3.1255242824554443, 3.175516128540039, 3.1815154552459717, 3.2115108966827393, 3.237506866455078, 3.2575039863586426, 3.2934985160827637, 3.313495397567749, 3.3354921340942383, 3.3694870471954346, 3.401482105255127, 3.4314775466918945, 3.4554736614227295, 3.4934680461883545, 3.523463487625122, 3.539461135864258, 3.587453603744507, 3.6194489002227783, 3.6474449634552, 3.6894378662109375, 3.7154338359832764, 3.769426107406616, 3.8054206371307373, 3.835415840148926, 3.8774096965789795, 3.9014062881469727, 3.911404609680176, 3.881409168243408, 3.9094045162200928, 3.9354007244110107, 3.905405282974243, 3.897406578063965, 3.881409168243408, 3.8654112815856934, 3.8614120483398438, 3.8254175186157227, 3.8294167518615723, 3.7894229888916016, 3.7654266357421875, 3.7794246673583984, 3.745429754257202, 3.733431577682495, 3.7054355144500732, 3.6894381046295166, 3.6814396381378174, 3.6774404048919678, 3.6674416065216064, 3.635446310043335, 3.6414456367492676, 3.6194489002227783, 3.6074507236480713, 3.5774550437927246, 3.561458110809326, 3.575455665588379, 3.5454602241516113, 3.5294625759124756, 3.5334620475769043, 3.5074660778045654, 3.513465166091919, 3.4934682846069336, 3.475470781326294, 3.473471164703369, 3.4774703979492188, 3.5134646892547607, 3.4314775466918945, 3.4314775466918945, 3.427478075027466, 3.4094808101654053, 3.413480281829834, 3.3914833068847656, 3.3954830169677734, 3.3934829235076904, 3.375486373901367, 3.385484457015991, 3.3714866638183594, 3.3714866638183594, 3.375485897064209, 3.3554890155792236, 3.3574891090393066, 3.347490072250366, 3.349490165710449, 3.3454906940460205, 3.3214943408966064, 3.337491750717163, 3.325493812561035, 3.325493812561035, 3.327493190765381, 3.311495542526245, 3.315495491027832, 3.3054966926574707, 3.303497076034546, 3.3074963092803955, 3.2954983711242676, 3.3054966926574707, 3.2974979877471924, 3.2934987545013428, 3.2934985160827637, 3.277500867843628, 3.2914984226226807, 3.2835001945495605, 3.291498899459839, 3.289499282836914, 3.2815003395080566, 3.289499282836914 }},
};



TubeVector deplace(TubeVector mesure, IntervalVector depl,int t_size,vector<IntervalVector> & r_de_thet_4,double & min_theta_4,double & max_theta_4){
  Tube r=mesure[0];
  Tube theta=mesure[1];
  Interval x =depl[0];
  Interval y =depl[1];
  Tube x21=r*cos(theta)-x;
  Tube y21=r*sin(theta)-y;
  Tube r_21=sqrt(sqr(x21)+sqr(y21));
  Tube theta_21=atan2(y21,x21);
  TubeVector sortie =TubeVector{r_21,theta_21};

  min_theta_4=sortie[1](0).lb();
  max_theta_4=sortie[1](0).ub();
  for (double t=0.0;t<t_size;t+=0.01){
    Interval r_4=sortie[0](t);
    Interval theta_4=sortie[1](t);
    IntervalVector to_add_4 {{0,0},{0,0}};
    to_add_4[0]=theta_4;
    to_add_4[1]=r_4;
    if ((theta_4.ub()-theta_4.lb())<1){
      min_theta_4=min(min_theta_4,theta_4.lb());
      max_theta_4=max(max_theta_4,theta_4.ub());
      r_de_thet_4.push_back(to_add_4);
    }
  }
  return sortie;

}

double similitude (Tube ref,Tube mesure_dep,double min_theta, double max_theta, double pas){
  double similitude =0.;
  for (double theta=min_theta;theta<max_theta;theta+=pas){
    Interval inter4 = mesure_dep(theta);
    Interval inter3 = ref(theta);
    Interval commun = inter3&inter4;
    if (commun.is_empty()==false){similitude+=1.;}

  }
  similitude=similitude*(max_theta-min_theta)/(1000*2*M_PI);
  return similitude;
}

Tube tube_de_proj(vector<IntervalVector> r_de_thet_4,double min_theta_4,double max_theta_4,double & theta4_pas){
  Interval theta4_domain(min_theta_4,max_theta_4);
  theta4_pas = (max_theta_4-min_theta_4)/1000;


  map<double,double> map_traj_inf_iss;
  map<double,double> map_traj_sup_iss;


  for (double theta=min_theta_4;theta<max_theta_4;theta+=theta4_pas){
    map_traj_inf_iss[theta]=100.;
    map_traj_sup_iss[theta]=0.;

  }

    for (const auto box : r_de_thet_4){
    double theta_min=box[0].lb();
    double theta_max=box[0].ub();
    for (double theta=min_theta_4;theta<max_theta_4;theta+=theta4_pas){
      if (theta_min<=theta && theta<=theta_max){
        map_traj_sup_iss[theta]=max(map_traj_sup_iss[theta],box[1].ub());
        map_traj_inf_iss[theta]=min(map_traj_inf_iss[theta],box[1].lb());
      }
    }
    for (double theta=min_theta_4;theta<max_theta_4;theta+=theta4_pas){
      if (theta<=theta_min && theta_min<(theta+theta4_pas)){
        map_traj_sup_iss[theta]=max(map_traj_sup_iss[theta],box[1].ub());
        map_traj_inf_iss[theta]=min(map_traj_inf_iss[theta],box[1].lb());
        if ((theta+theta4_pas)<max_theta_4){
          map_traj_sup_iss[theta+theta4_pas]=max(map_traj_sup_iss[theta+theta4_pas],box[1].ub());
          map_traj_inf_iss[theta+theta4_pas]=min(map_traj_inf_iss[theta+theta4_pas],box[1].lb());
        }
      }
    }
    for (double theta=min_theta_4;theta<max_theta_4;theta+=theta4_pas){
      if (theta<=theta_max&& theta_max<(theta+theta4_pas)){
        map_traj_sup_iss[theta]=max(map_traj_sup_iss[theta],box[1].ub());
        map_traj_inf_iss[theta]=min(map_traj_inf_iss[theta],box[1].lb());
        if ((theta+theta4_pas)<max_theta_4){
          map_traj_sup_iss[theta+theta4_pas]=max(map_traj_sup_iss[theta+theta4_pas],box[1].ub());
          map_traj_inf_iss[theta+theta4_pas]=min(map_traj_inf_iss[theta+theta4_pas],box[1].lb());
        } 
      }
    }
  }

  for (double theta=min_theta_4;theta<max_theta_4;theta+=theta4_pas){
      if (map_traj_inf_iss[theta]==100.){map_traj_inf_iss[theta]=0.;}

    }



  Trajectory traj_inf_iss (map_traj_inf_iss);
  Trajectory traj_sup_iss (map_traj_sup_iss);
  Tube iss (traj_inf_iss,traj_sup_iss,theta4_pas);
  return iss;
}

void registration_solver(Tube ref,TubeVector mesure,IntervalVector zone,int t_size, double epsilon,double arret, VIBesFigMap& fig_map, vector<IntervalVector>& boxes_in){
  if ((zone[0].ub()-zone[0].lb())<epsilon || (zone[1].ub()-zone[1].lb())<epsilon){
    //cout<<zone<<endl;
    boxes_in.push_back(zone);
    fig_map.draw_box(zone,"green[green]");
    fig_map.show();
  }
  else {
    vector<IntervalVector> r_de_thet;
    double min_theta;
    double max_theta;
    double theta_pas;
    TubeVector tube_deplace = deplace(mesure,zone,t_size,r_de_thet,min_theta,max_theta);
    Tube issue = tube_de_proj(r_de_thet,min_theta,max_theta,theta_pas);
    double simil=similitude(ref,issue,min_theta,max_theta,theta_pas);
    if (simil>arret){
      IntervalVector box1 (2);
      IntervalVector box2 (2);
      decoupe_box(zone,box1,box2);
      registration_solver(ref,mesure,box1,t_size,epsilon,arret,fig_map,boxes_in);
      registration_solver(ref,mesure,box2,t_size,epsilon,arret,fig_map,boxes_in);
    }
    else {fig_map.draw_box(zone,"red[red]");    fig_map.show();}
  }
}

int main()
{

  string line;

  ifstream myfile3 ("mesures_r/acquisition3_estim.txt");
  long double angle3=0.;
  long double valeur3=0.;
  if (myfile3.is_open())
  {
    while ( getline (myfile3,line) )
    {
      if (line.find("theta")!= string::npos){
        long double angle = std::stold(line.substr(8));
        if (abs(angle)>0.01){
          angle3+=angle;
          valeur3 +=1.;
        }
      }
    }
    myfile3.close();
    angle3=angle3/valeur3;
    cout<<"angle3 :"<<angle3<<endl;
  }

  ifstream myfile4 ("mesures_r/acquisition4_estim.txt");
  long double angle4=0.;
  long double valeur4=0.;
  if (myfile4.is_open())
  {
    while ( getline (myfile4,line) )
    {
      if (line.find("theta")!= string::npos){
        long double angle = std::stold(line.substr(8));
        if (abs(angle)>0.01){
          angle4+=angle;
          valeur4 +=1.;
        }
      }
    }
    myfile4.close();
    angle4=angle4/valeur4;
    cout<<"angle4 :"<<angle4<<endl;
  }

  ifstream myfile5 ("mesures_r/acquisition5_estim.txt");
  long double angle5=0.;
  long double valeur5=0.;
  if (myfile5.is_open())
  {
    while ( getline (myfile5,line) )
    {
      if (line.find("theta")!= string::npos){
        long double angle = std::stold(line.substr(8));
        if (abs(angle)>0.01){
          angle5+=angle;
          valeur5 +=1.;
        }
      }
    }
    myfile5.close();
    angle5=angle5/valeur5;
    cout<<"angle5 :"<<angle5<<endl;
  }

  cout<<"rotation de 3 vers 4 : "<<setprecision(12)<<(angle4-angle3)<<endl;
  cout<<"rotation de 3 vers 5 : "<<setprecision(12)<<(angle5-angle3)<<endl;
  cout<<"rotation de 4 vers 5 : "<<setprecision(12)<<(angle5-angle4)<<endl;
  long double angle34=pi/4;
  long double angle35 = (angle5-angle3);

  // Setup the initial box
  auto max_red=*max_element(ranges["red"].begin(), ranges["red"].end());
  auto max_blue=*max_element(ranges["blue"].begin(), ranges["blue"].end());
  auto max_green=*max_element(ranges["green"].begin(), ranges["green"].end());


  IntervalVector box(2, {-max_red-1, max_red+1});
  IntervalVector box_cp(2, {-max_red-1, max_red+1});
  IntervalVector box_blue(2, {-max_blue-1, max_blue+1});
  IntervalVector box_diff34(2, {-max_blue-1, max_blue+1});
  IntervalVector box_green(2, {-max_green-1, max_green+1});
  IntervalVector box_deltaS4(2, {-max_blue-1, max_blue+1});




  double dt =0.01;
  Interval tdomain (0.,10.);
  double pas= 0.00700000021607;
  map<double,double> map_lidar3_r;
  map<double,double> map_lidar3_theta;
  map<double,double> map_lidar4_r;
  map<double,double> map_lidar4_theta;
  map<double,double> map_lidar5_r;
  map<double,double> map_lidar5_theta;
  // IntervalVector p_test{{2.7,3.5},{-1.2,-0.8}}; A GARDER, BON RESULTAT
  IntervalVector p_test{{2.7,3.5},{-1.2,-0.8}};
  IntervalVector mult_test{{-0.4,0.4},{-0.4,0.4}};





  Interval rho0 (0.,3.2695021629333496);
  Interval theta0 (-0,-0+pas);
  SepPolarXY sep_polar0(rho0,theta0);

  Array<Sep> arr(sep_polar0);
  vector<SepPolarXY> arr1;

  Interval rho0_blue (0.,3.7034361362457275);
  Interval theta0_blue (-0+angle34,-0+pas+angle34);
  SepPolarXY sep_polar0_blue(rho0_blue,theta0_blue);

  Array<Sep> arr_blue(sep_polar0_blue);
  vector<SepPolarXY> arr1_blue;
  Interval rho0_deltaS4 (3.7034361362457275-0.02,3.7034361362457275+0.02);
  SepPolarXY sep_polar0_deltaS4(rho0_deltaS4,theta0_blue);
  Array<Sep> deltaS4_arr(sep_polar0_deltaS4);
  vector<SepPolarXY> deltaS4_arr1;
  //ensemble M : map soit tout sauf murs

  Interval rho0_green (0.,5.633142471313477);
  Interval theta0_green (-0+angle35,-0+pas+angle35);
  SepPolarXY sep_polar0_green(rho0_green,theta0_green);


  Array<Sep> arr_green(sep_polar0_green);
  vector<SepPolarXY> arr1_green;

  for(const auto& [color,data] : ranges){
    double t0=0.;
    if (color=="red"){
      double a=-pi;
      
      for(const auto& r : data)
      {
        if(r < 0.) continue; // equiv to inf data
          Interval rho (0.,r);
          Interval theta (a,a+pas);
          map_lidar3_r[(ceil(t0*100.0)/100.0)]=r;
          map_lidar3_theta[(ceil(t0*100.0)/100.0)]=a;
          theta.inflate(0.03);
          a+=pas;
          t0+=0.01;
          SepPolarXY sep_polar(rho,theta);
          arr1.push_back(sep_polar);
      }
    
    }

    if (color=="blue"){
      double a=-pi;

      for(const auto& r : data){
        if(r < 0.) continue; // equiv to inf data
          Interval rho_blue (0.,r);
          Interval rho_blue_delta(r,r);
          rho_blue_delta.inflate(0.02);
          Interval theta_blue (a+angle34,a+pas+angle34);
          Interval theta_deltaS4 (a+angle34,a+pas+angle34);
          theta_blue.inflate(0.03);
          a+=pas;
          t0+=0.01;
          SepPolarXY sep_polar_blue(rho_blue,theta_blue);
          SepPolarXY sep_polar_blue_delta(rho_blue_delta,theta_deltaS4);
          arr1_blue.push_back(sep_polar_blue);
          deltaS4_arr1.push_back(sep_polar_blue_delta);

          double angle = a+angle34;
          if (angle >pi){
            angle=angle-(2*pi);
          }
          else if (angle<-pi){
            angle = angle +2*pi;
          }
          map_lidar4_r[(ceil(t0*100.0)/100.0)]=r;
          map_lidar4_theta[(ceil(t0*100.0)/100.0)]=angle;

      }
    
    }

    if (color=="green"){
      double a=-pi;

      for(const auto& r : data){
        if(r < 0.) continue; // equiv to inf data
          Interval rho_green (0.,r);
          Interval theta_green (a+angle35,a+pas+angle35);
          theta_green.inflate(0.03);
          a+=pas;
          t0+=0.01;
          SepPolarXY sep_polar_green(rho_green,theta_green);
          arr1_green.push_back(sep_polar_green);
          double angle = a+angle35;
          cout<< a<<endl;
          if (angle >pi){
            angle=angle-(2*pi);
          }
          else if (angle<-pi){
            angle = angle +2*pi;
          }
          map_lidar5_r[(ceil(t0*100.0)/100.0)]=r;
          map_lidar5_theta[(ceil(t0*100.0)/100.0)]=angle;
      }
    
    }

  }
  for (int j=0;j<arr1.size();j++){arr.add(arr1[j]);}
  for (int j=0;j<arr1_blue.size();j++){arr_blue.add(arr1_blue[j]);}
  for (int j=0;j<arr1_green.size();j++){arr_green.add(arr1_green[j]);}

  for (int j=0;j<deltaS4_arr1.size();j++){deltaS4_arr.add(deltaS4_arr1[j]);}

  SepUnion sep_union(arr);
  SepUnion sep_union_blue(arr_blue);
  SepUnion sep_union_green(arr_green);
  SepUnion sep_union_deltaS4(deltaS4_arr);




  Trajectory mesures_lidar3_r (map_lidar3_r);
  Trajectory mesures_lidar3_theta (map_lidar3_theta);
  int size_data3 = map_lidar3_r.size();
  TrajectoryVector mesures_lidar3_vec(2,mesures_lidar3_r );
  mesures_lidar3_vec[1]=mesures_lidar3_theta;
  TubeVector mesure3_tub_vec (mesures_lidar3_vec,0.01);




  Trajectory mesures_lidar4_r (map_lidar4_r);
  Trajectory mesures_lidar4_theta (map_lidar4_theta);
  int size_data4 = map_lidar4_r.size();
  cout<<map_lidar4_r.size()<<"  "<<map_lidar4_theta.size()<<endl;
  TrajectoryVector mesures_lidar4_vec(2,mesures_lidar4_r );
  mesures_lidar4_vec[1]=mesures_lidar4_theta;
  TubeVector mesure_4_tub_vec (mesures_lidar4_vec,0.01);

  Trajectory mesures_lidar5_r (map_lidar5_r);
  Trajectory mesures_lidar5_theta (map_lidar5_theta);
  int size_data5 = map_lidar5_r.size();
  cout<<map_lidar5_r.size()<<"  "<<map_lidar5_theta.size()<<endl;
  TrajectoryVector mesures_lidar5_vec(2,mesures_lidar5_r );
  mesures_lidar5_vec[1]=mesures_lidar5_theta;
  TubeVector mesure_5_tub_vec (mesures_lidar5_vec,0.01);

  double min_theta_4;
  double max_theta_4;
  double theta4_pas;
  vector<IntervalVector> r_de_thet_4;

  TubeVector tube_depl=deplace(mesure_4_tub_vec,p_test,size_data4,r_de_thet_4,min_theta_4,max_theta_4);
  Tube iss = tube_de_proj(r_de_thet_4,min_theta_4,max_theta_4,theta4_pas);

  IntervalVector ref {{0,0},{0,0}};

  vector<IntervalVector> r_de_thet_3;
  double min_theta_3;
  double max_theta_3;
  double theta3_pas;
  TubeVector ref_3_tubvec =deplace(mesure3_tub_vec,ref,size_data3,r_de_thet_3,min_theta_3,max_theta_3);
  Tube iss_3 = tube_de_proj(r_de_thet_3,min_theta_3,max_theta_3,theta3_pas);



  vibes::beginDrawing();
  VIBesFigMap fig_map ("registration solver");
  fig_map.set_properties(50, 50, 400, 400);


  vector<IntervalVector> boxes_in;
  auto start = std::chrono::system_clock::now();
  for (double i=-10.;i<10;i+=1.){
    for (double j=-10.;j<10;j+=1.){
      IntervalVector zone_de_recherche {{i,i+1.},{j,j+1.}};
      registration_solver(iss_3,mesure_4_tub_vec,zone_de_recherche,size_data4,0.1,0.50,fig_map,boxes_in); //ICI34
    }
  }
  auto end = std::chrono::system_clock::now();
  std::chrono::duration<double> elapsed_seconds = end-start;
  std::time_t end_time = std::chrono::system_clock::to_time_t(end);

  std::cout << "finished computation at " << std::ctime(&end_time)
            << "elapsed time: " << elapsed_seconds.count() << "s"
            << std::endl;

  cout<<boxes_in.size()<<endl;

  VIBesFigMap fig_map_35 ("registration solver_35");
  fig_map_35.set_properties(50, 50, 400, 400);


  vector<IntervalVector> boxes_in_35;
  for (double i=-10.;i<10;i+=1.){
    for (double j=-10.;j<10;j+=1.){
      IntervalVector zone_de_recherche {{i,i+1.},{j,j+1.}};
      registration_solver(iss_3,mesure_5_tub_vec,zone_de_recherche,size_data5,0.03,0.50,fig_map_35,boxes_in_35); //ICI35
    }
  }

  

  //registration_solver(iss_3,mesure_4_tub_vec,zone_de_recherche,0.5,fig_map);


  IntervalVector box_union_34 (boxes_in[0]);
  IntervalVector box_union_35 (boxes_in_35[0]);
  for (const auto&ele : boxes_in){
    box_union_34=box_union_34|ele;
  }
  for (const auto&ele : boxes_in_35){
    box_union_35=box_union_35|ele;
  }

  ostringstream o_34;
  o_34<<"(x[0]+"<<box_union_34[0]<<",x[1] + "<<box_union_34[1]<<")";
  auto o_34_str = o_34.str();

  ostringstream o_35;
  o_35<<"(x[0]+"<<box_union_35[0]<<",x[1] + "<<box_union_35[1]<<")";
  auto o_35_str = o_35.str();

  ostringstream o_34_m;
  o_34_m<<"(x[0]-"<<box_union_34[0]<<",x[1] - "<<box_union_34[1]<<")";
  auto o_34_str_m = o_34_m.str();

  ostringstream o_35_m;
  o_35_m<<"(x[0]-"<<box_union_35[0]<<",x[1] - "<<box_union_35[1]<<")";
  auto o_35_str_m = o_35_m.str();

  Function f34 ("x[2]",o_34_str.c_str());
  Function f35 ("x[2]",o_35_str.c_str());
  Function f34_m ("x[2]",o_34_str_m.c_str());
  Function f35_m ("x[2]",o_35_str_m.c_str());

  SepTransform sep_34_dep(sep_union_blue,f34,f34_m);
  SepTransform sep_35_dep(sep_union_green,f35,f35_m);
  SepUnion sep_carte_tt (sep_union,sep_34_dep,sep_35_dep);

  VIBesFigTube fig_dist("map_lidar3");
  fig_dist.set_properties(100, 100, 600, 300);
  //fig_dist.add_trajectories(&mesures_lidar3_vec, "mesures_lidar3_vec","red[pink]");
  //fig_dist.add_trajectories(&mesures_lidar4_vec, "mesures_lidar4_vec","black[Grey]");
  fig_dist.add_tubes(&mesure3_tub_vec,"mesure3_tub_vec","Blue[LightBlue]");


  fig_dist.show();

  VIBesFigTube fig_dist1("map_lidar4");
  fig_dist.set_properties(100, 100, 600, 300);
  //fig_dist1.add_trajectories(&mesures_lidar3_vec, "mesures_lidar3_vec","red[pink]");
  //fig_dist1.add_trajectories(&mesures_lidar4_vec, "mesures_lidar4_vec","black[Grey]");
  fig_dist1.add_tubes(&mesure_4_tub_vec,"mesure_4_tub_vec","Orange");
  fig_dist1.add_tubes(&tube_depl,"tube_depl","red");
  /*fig_dist1.add_tube(&tub_sum4,"tub_sum4","brown");
  fig_dist1.add_tube(&tub_diff_4,"tub_diff_4","red");*/

  fig_dist1.show();

  VIBesFigMap fig("r en fonction de theta en boxes");
  fig.set_properties(50, 50, 400, 400); // position and size
  for (const auto& ele : r_de_thet_4){
    fig.draw_box(ele,"red");
  }
  fig.show(); // display all items of the figure

  VIBesFigTube fig_rtheta("r en fonction de theta (mesure 4)");
  fig_rtheta.set_properties(100, 100, 600, 300);
  fig_rtheta.add_tube(&iss,"iss");
  /*fig_rtheta.add_trajectory(&traj_inf_iss, "traj_inf_iss");
  fig_rtheta.add_trajectory(&traj_sup_iss, "traj_sup_iss","green");*/
  for (const auto& ele : r_de_thet_4){
    fig_rtheta.draw_box(ele,"red[red]");
  }
  fig_rtheta.show();

  VIBesFigTube fig_rtheta3("r en fonction de theta (mesure 3)");
  fig_rtheta3.set_properties(100, 100, 600, 300);
  fig_rtheta3.add_tube(&iss_3,"iss3");
  /*fig_rtheta3.add_trajectory(&traj_inf_3, "traj_inf_3");
  fig_rtheta3.add_trajectory(&traj_sup_3, "traj_sup_3","green");*/
  for (const auto& ele : r_de_thet_3){
    fig_rtheta3.draw_box(ele,"red[red]");
  }
  fig_rtheta3.show();

  VIBesFigTube fig_thetadep_ref("comparaison des tubes mesure 3 (noir) et mesure 4 déplacé (bleu)");
  fig_thetadep_ref.set_properties(100, 100, 600, 300);
  fig_thetadep_ref.add_tube(&iss,"iss","blue[lightGray]");
  fig_thetadep_ref.add_tube(&iss_3,"iss3","black[darkGray]");
  fig_thetadep_ref.show();

  vibes::endDrawing();




  // Graphics
  vibes::beginDrawing();

  vibes::newFigure("mesure 3");
  vibes::setFigureProperties(vibesParams("x",100, "y",100, "width",500, "height",500));
  auto Map_3 = SIVIA(box, sep_union, 0.1,true, "mesure 3",true);
  Map_3[SetValue::IN].insert(Map_3[SetValue::IN].end(), Map_3[SetValue::UNKNOWN].begin(), Map_3[SetValue::UNKNOWN].end());

  vibes::drawBox(-box_union_34);
  vibes::drawBox(-box_union_35);
  IntervalVector vrai35 {{-0.6-0.01,-0.6+0.01},{2.7-0.01,2.7+0.01}};
  IntervalVector vrai34 {{-3.-0.01,-3.+0.01},{0.9-0.01,0.9+0.01}};
  vibes::drawBox(vrai35,"red[red]");
  vibes::drawBox(vrai34,"red[red]");
  
  vibes::newFigure("carte totale");
  vibes::setFigureProperties(vibesParams("x",100, "y",100, "width",500, "height",500));
  SIVIA(box_cp, sep_carte_tt, 0.1, "carte totale");

  /*auto Map = Map_3[SetValue::IN];        //M et M barre, à utiliser avec sep_union_blue (ensemble de S) et sep_union_deltaS4 (ensemble de delta S)
  auto Map_bar = Map_3[SetValue::OUT];  //P =intersect_i(M - Si ) ∩ (M_bar ⊕ −∆S i )

  vibes::newFigure("mesure 4");
  vibes::setFigureProperties(vibesParams("x",100, "y",100, "width",500, "height",500));
  auto Map4=SIVIA(box_blue, sep_union_blue, 0.1,true, "mesure 4",true);
  Map4[SetValue::IN].insert(Map4[SetValue::IN].end(), Map4[SetValue::UNKNOWN].begin(), Map4[SetValue::UNKNOWN].end());

  auto S = Map4[SetValue::IN];


  vibes::newFigure("mesure 5");
  vibes::setFigureProperties(vibesParams("x",100, "y",100, "width",500, "height",500));
  SIVIA(box_green, sep_union_green, 0.1, "mesure 5");
  vibes::newFigure("deltaS4");
  vibes::setFigureProperties(vibesParams("x",100, "y",100, "width",500, "height",500));
  auto Map4_delta=SIVIA(box_deltaS4, sep_union_deltaS4,true, 0.1, "deltaS4",true);
  Map4_delta[SetValue::IN].insert(Map4_delta[SetValue::IN].end(), Map4_delta[SetValue::UNKNOWN].begin(), Map4_delta[SetValue::UNKNOWN].end());

  auto delta_S = Map4_delta[SetValue::IN];

  vibes::endDrawing();*/
  return 0;
}